# Программа для перевода книг

Эта программа предназначена для автоматического перевода книг с использованием API OpenRouter.

## Подготовка к использованию

1. Убедитесь, что у вас установлен Node.js и npm.
2. Клонируйте репозиторий и перейдите в папку проекта.
3. Установите зависимости, выполнив команду:
   ```
   npm install
   ```
4. Создайте файл `.env` в корневой папке проекта и добавьте в него ваш API ключ OpenRouter:
   ```
   OPENROUTER_API_KEY=ваш_api_ключ_здесь
   ```

## Структура файлов и папок

- `data/`: папка для исходных файлов
  - `sections/`: папка с файлами разделов книги для перевода
  - `toc.json`: файл с оглавлением книги
- `result/`: папка для результатов перевода
- `logs/`: папка для логов (создается автоматически)

## Подготовка файлов для перевода

1. Создайте папку `data/sections/` и поместите в нее файлы разделов книги в формате Markdown (.md).
2. Создайте файл `data/toc.json` со структурой оглавления книги. Пример:
   ```json
   [
     {
       "title": "Название главы 1",
       "page": 1,
       "fileName": "c1.md",
       "chapter": "Глава 1"
     },
     {
       "title": "Название раздела 1.1",
       "page": 2,
       "fileName": "c1s1.md",
       "chapter": "Глава 1"
     }
   ]
   ```

## Настройка параметров перевода

1. Скопируйте файл `config.example.ts` и переименуйте его в `config.ts`.
2. Откройте файл `config.ts` и настройте следующие параметры:

   - `targetLanguage`: язык перевода (например, "Russian")
   - `modelName`: модель для перевода (например, "anthropic/claude-3.5-sonnet")
   - `chunkSize`: размер фрагмента текста для перевода (по умолчанию 1000)
   - `pageFilter`: функция фильтрации страниц для перевода

   Пример конфигурации:

   ```typescript
   export const targetLanguage = "Russian";
   export const modelName: ModelName = "anthropic/claude-3.5-sonnet";
   export const chunkSize = 1000;

   export const pageFilter = (section: { page: number; fileName: string }) =>
     (section.page >= 1 && section.page < 100) ||
     section.fileName.startsWith("chapter1");
   ```

## Запуск программы

1. Убедитесь, что вы создали и настроили файл `config.ts`.
2. Выполните следующую команду для запуска процесса перевода:

   ```
   npx ts-node translateBook.ts
   ```

## Результаты

После завершения работы программы:

1. Переведенные файлы будут сохранены в папке `result/[язык]/[модель]/`.
2. Оригинальные тексты будут сохранены в папке `result/kr/`.
3. Логи запросов к API будут сохранены в папке `logs/`.

## Запуск бота в Docker

### Использование Docker Compose (рекомендуется)

1. Убедитесь, что у вас установлены Docker и Docker Compose
2. Создайте файл `.env` на основе `.env.example`
3. Запустите бота с помощью команды:
   ```bash
   docker-compose up -d
   ```
4. Для просмотра логов используйте:
   ```bash
   docker-compose logs -f
   ```
5. Для остановки бота:
   ```bash
   docker-compose down
   ```

### Использование Docker напрямую

1. Соберите образ:
   ```bash
   docker build -t translator-bot .
   ```
2. Запустите контейнер:
   ```bash
   docker run -d --env-file .env --name translator-bot translator-bot
   ```

## Примечание

Убедитесь, что у вас достаточно средств на счету OpenRouter для выполнения перевода. Стоимость может варьироваться в зависимости от выбранной модели и объема текста.
